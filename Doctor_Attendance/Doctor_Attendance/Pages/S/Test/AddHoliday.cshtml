@page
@model Doctor_Attendance.Pages.S.Test.AddHolidayModel
@{
}
<!DOCTYPE html>
<html>
<head>
    <title>Add Holiday</title>
     <!-- Add these links for Bootstrap CSS and JS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" >
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" ></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" ></script>

</head>
<body>
    <h1>Add Holiday</h1>
    <form method="post" >
<p>


    
        @{
            var currentDate = DateTime.Now;
        }
    <input  type="text" id="datepicker" asp-for="@Model.Input.Date"   value="@Model.Input.Date.ToString("yyyy-MM-dd")" />
    
    &nbsp; &nbsp; &nbsp;

    <input type="text" asp-for="@Model.Input.Reason">

    &nbsp; &nbsp; &nbsp;
    
    <button type="submit" class="btn btn-primary">Add Holiday </button>
    </p>        
        @if (!string.IsNullOrEmpty(Model.ValidStr))
        {
           if(!Model.ValidStr.Equals(""))
            {
               <span style="color: red; margin-left: 10px;">@Model.ValidStr</span> 
            } 
        }
        
            
        
    </form>
    
    <!-- Table of Holidays -->
    <div id="HolidaysTable">

     <table class="table">
       <thead>
        <tr>
         <th>
          Date
         </th>
         <th>
          Reason
         </th>
         </thead>
         <tbody>
             @foreach (var item in Model.Holidays)
       {
                
              <tr>
             <td>@Model.Input.Date.ToString("yyyy-MM-dd")</td>                           
             <td>@Html.DisplayFor(modelItem => item.Name) /></td>
              </tr>
       }
         </tbody>  
         </table>
         <div class="mb-3">
          <button type="submit" class="btn btn-primary">Update </button>
          </div>
        </div>
    </body>
</html>
 @section Scripts {
    <script>
        $(function () {
            $("#datepicker").attr("max", getCurrentDate());

            function getCurrentDate() {
                var currentDate = new Date();
                currentDate.setDate(currentDate.getDate() + 1);
                var year = currentDate.getFullYear();
                var month = ("0" + (currentDate.getMonth() + 1)).slice(-2);
                var day = ("0" + currentDate.getDate()).slice(-2);
                return `${year}-${month}-${day}`;
            }

            $("#datepicker").change(function () {
                var selectedDate = $(this).val();
                $('[id^="datePicker_"]').val(selectedDate);
            });
        });
    </script>
    <script>
        $(function () {
            $("#datepicker").datepicker({
                dateFormat: "yy-mm-dd",
                maxDate: "+0d",
                beforeShowDay: function (date) {
                    var currentDate = new Date();
                    currentDate.setHours(0, 0, 0, 0);
                    var day = date.getDay(); // Get the day of the week (0-6, where 0 is Sunday)
                    var formattedDate = $.datepicker.formatDate("dd/mm", date); // Get the formatted date (dd/mm)
                     var disabledDates = ["22/11", "01/06", "10/12", "25/12"];
                    // Disable Saturdays (day = 6), Sundays (day = 0)
                    if (day === 0 || day === 6 ) {
                        return [false];
                    }
                    // Disable specific dates
                    for (var i = 0; i < disabledDates.length; i++) {
                     if (formattedDate === disabledDates[i]) {
                       return [false];
                 
                     }
                    }
                    return [date <= currentDate];
                },
                onSelect: function (dateText) {
                    $('[id^="datePicker_"]').val(dateText);
                }
            });
        });
    </script>
    

}

